<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Generative AI Engineer Associate Quiz</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
 <link rel="stylesheet" href="../all.css">
 <link rel="icon" type="image/png" href="../Img/icon1.png">
</head>
<body>

  <div class="quiz-container">
    <h1>Google Cloud Platform (GCP) Cloud Digital Leader</h1>
    <div class="progress">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <h2>Choose a Quiz Section:</h2>
    <button class="btn" onclick="loadRandomQuestion()">Random Practice (45 Questions)</button>
    <button class="btn" onclick="showPracticeRangeForm()">Start Practice</button>

    <div class="quiz-layout">
      <div class="quiz-main">
        <div id="quiz" style="display: none;"></div>
        <div class="feedback" id="feedback" style="display: none;"></div>
      </div>
      <div class="quiz-aside">
        <div class="quiz-actions">
          <button class="btn" id="submit-btn" style="display: none;" onclick="submitAnswer()">Submit</button>
          <button class="btn" id="next-btn" style="display: none;" onclick="nextQuestion()">Next</button>
        </div>
        <div class="score-container" id="score-container" style="display:none;">
          <canvas id="scoreChart"></canvas>
          <div id="scoreSummary" class="score-summary"></div>
          <button class="btn" id="start-over-btn" onclick="location.reload()">Start Over</button>
        </div>
      </div>
    </div>
  </div>

  <div id="popupOverlay"></div>
  <div id="practicePopup">
    <div class="question">Enter Question Range to Practice:</div>
    <h3 id="availableCount">59 Question available</h3>
    <div class="range-inputs">
      <input type="number" id="rangeStart" placeholder="Start (e.g. 2)" />
      <input type="number" id="rangeEnd" placeholder="End (e.g. 50)" />
    </div>
    <button class="btn" onclick="startPracticeRange()">Start Practice</button>
  </div>

    <script>
      let currentIndex = 0;
      let score = 0;
      let section = 0;
      let customQuestionList = [];

      function startQuiz(sectionNumber) {
        section = sectionNumber;
        currentIndex = (sectionNumber - 1) * questionsInSection;
        score = 0;
        document.querySelector(".quiz-container h2").style.display = "none";
        document.querySelectorAll(".quiz-container button").forEach(btn => btn.style.display = "none");
        document.getElementById("quiz").style.display = "block";
        document.getElementById("submit-btn").style.display = "inline-block";
        document.getElementById("feedback").style.display = "block";
        showQuestion();
        updateProgress();
      }

      function showQuestion() {
        const quiz = document.getElementById("quiz");
        const q = questions[currentIndex];
        let html = `<div class="question">Question ${currentIndex + 1}: ${q.question}</div><div class="options">`;
        q.options.forEach((opt, i) => {
          html += `<label><input type="radio" name="option" value="${i}"> ${opt}</label>`;
        });
        html += `</div>`;
        quiz.innerHTML = html;
        document.getElementById("feedback").innerText = '';
        document.getElementById("submit-btn").style.display = "inline-block";
        document.getElementById("next-btn").style.display = "none";
      }

      function submitAnswer() {
        const selected = document.querySelector('input[name="option"]:checked');
        if (!selected) return alert("Please select an option.");

        const selectedValue = parseInt(selected.value);
        const q = section === -1 ? customQuestionList[currentIndex] : questions[currentIndex];
        const correctAnswer = q.answer;
        const correctText = q.options[correctAnswer];

        if (selectedValue === correctAnswer) {
          score++;
          document.getElementById("feedback").innerHTML = "<span class=\"feedback-success\">✅ Correct!</span>";
        } else {
          document.getElementById("feedback").innerHTML = `
            <span class="feedback-label">❌ Incorrect. Correct answer:</span>
            <span class="feedback-answer">${correctText}</span>
          `;
        }

        document.getElementById("submit-btn").style.display = "none";
        document.getElementById("next-btn").style.display = "inline-block";
      }

      function nextQuestion() {
        currentIndex++;
        if (section === -1) {
          if (currentIndex < customQuestionList.length) {
            showCustomPracticeQuestion();
            updateProgress();
          } else showScore();
        } else {
          const maxIndex = section * questionsInSection;
          if (currentIndex < maxIndex && currentIndex < questions.length) {
            showQuestion();
            updateProgress();
          } else showScore();
        }
      }

      function showScore() {
        document.getElementById("quiz").style.display = "none";
        document.getElementById("submit-btn").style.display = "none";
        document.getElementById("next-btn").style.display = "none";
        document.getElementById("feedback").style.display = "none";
        document.getElementById("progressBar").style.width = "100%";
        document.getElementById("score-container").style.display = "block";

        const total = section === -1 ? customQuestionList.length : questionsInSection;
        const summaryNode = document.getElementById("scoreSummary");
        if (summaryNode) summaryNode.textContent = `✅ ${score} / ${total}`;

        const ctx = document.getElementById('scoreChart').getContext('2d');
        const percentage = total > 0 ? (score / total) * 100 : 0;

        new Chart(ctx, {
          type: 'doughnut',
          data: {
            datasets: [{
              data: [percentage, 100 - percentage],
              backgroundColor: ['#4caf50', '#eee'],
              borderWidth: 5
            }]
          },
          options: {
            cutout: '75%',
            plugins: {
              tooltip: { enabled: false },
              legend: { display: false },
              title: {
                display: true,
                text: `✅ ${score} / ${total}`,
                color: '#333',
                font: { size: 22, weight: 'bold' }
              }
            }
          }
        });

        document.getElementById("start-over-btn").style.display = "inline-block";
      }

      function loadRandomQuestion() {
        section = -1;
        const shuffled = [...questions].sort(() => 0.5 - Math.random());
        customQuestionList = shuffled.slice(0, 45);
        currentIndex = 0;

        document.querySelector(".quiz-container h2").style.display = "none";
        document.querySelectorAll(".quiz-container button").forEach(btn => btn.style.display = "none");
        document.getElementById("quiz").style.display = "block";
        document.getElementById("submit-btn").style.display = "inline-block";
        document.getElementById("feedback").style.display = "block";

        showCustomPracticeQuestion();
        updateProgress();
      }

      function showPracticeRangeForm() {
        const availableCount = document.getElementById("availableCount");
        if (availableCount) {
          availableCount.innerText = `${questions.length} Question${questions.length === 1 ? "" : "s"} available`;
        }
        document.getElementById("practicePopup").style.display = "block";
        document.getElementById("popupOverlay").style.display = "block";
      }

      function startPracticeRange() {
        const start = parseInt(document.getElementById("rangeStart").value) - 1;
        const end = parseInt(document.getElementById("rangeEnd").value);

        if (isNaN(start) || isNaN(end) || start < 0 || end > questions.length || start >= end) {
          alert("Please enter a valid range.");
          return;
        }

        document.getElementById("practicePopup").style.display = "none";
        document.getElementById("popupOverlay").style.display = "none";

        customQuestionList = questions.slice(start, end);
        currentIndex = 0;
        section = -1;

        document.getElementById("quiz").style.display = "block";
        document.getElementById("submit-btn").style.display = "inline-block";
        document.getElementById("feedback").style.display = "block";
        document.querySelector(".quiz-container h2").style.display = "none";
        document.querySelectorAll(".quiz-container button").forEach(btn => btn.style.display = "none");

        showCustomPracticeQuestion();
        updateProgress();
      }

      function showCustomPracticeQuestion() {
        const quiz = document.getElementById("quiz");
        const q = customQuestionList[currentIndex];
        let html = `<div class="question">Practice Question ${currentIndex + 1}: ${q.question}</div><div class="options">`;
        q.options.forEach((opt, i) => {
          html += `<label><input type="radio" name="option" value="${i}"> ${opt}</label>`;
        });
        html += `</div>`;
        quiz.innerHTML = html;
        document.getElementById("feedback").innerText = '';
        document.getElementById("submit-btn").style.display = "inline-block";
        document.getElementById("next-btn").style.display = "none";
      }

      function updateProgress() {
        let progressPercent;
        if (section === -1) {
          progressPercent = (currentIndex / customQuestionList.length) * 100;
        } else {
          const start = (section - 1) * questionsInSection;
          const answered = currentIndex - start;
          progressPercent = (answered / questionsInSection) * 100;
        }
        document.getElementById("progressBar").style.width = `${progressPercent}%`;
      }
    </script>

  <script src="./data.js"></script>
</body>
</html>